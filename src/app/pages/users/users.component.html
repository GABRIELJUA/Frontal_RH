<div class="space-y-6">

  <!-- Header -->

  <div>
    <h2 class="text-xl font-semibold text-slate-800 dark:text-white">
      Usuarios del sistema
    </h2>
    <p class="text-xs text-slate-400 mt-1">
      Gesti√≥n de accesos y permisos
    </p>
  </div>

  <!-- Estados -->

  <div *ngIf="loading" class="p-10 text-center text-slate-400 text-sm">
    Cargando usuarios‚Ä¶
  </div>

  <div *ngIf="errorMessage" class="p-6 text-red-600 text-sm font-semibold">
    {{ errorMessage }}
  </div>

  <!-- Tabla -->

  <div *ngIf="!loading && employees.length"
    class="bg-white dark:bg-[#020617] border border-slate-200 dark:border-slate-800 rounded-xl overflow-hidden">
    <table class="min-w-full text-sm">

      <thead class="bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800">
        <tr class="text-xs text-slate-500 dark:text-slate-400 uppercase tracking-wider">
          <th class="px-6 py-3 text-left">Usuario</th>
          <th class="px-6 py-3 text-left">Correo</th>
          <th class="px-6 py-3 text-left">Rol</th>
          <th class="px-6 py-3 text-left">Departamento</th>
          <th class="px-6 py-3 text-center">Acciones</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-slate-100 dark:divide-slate-800">

        <tr *ngFor="let u of employees" class="hover:bg-slate-50 dark:hover:bg-slate-900 transition">

          <td class="px-6 py-4 font-medium text-slate-800 dark:text-white">
            {{ u.nombre }} {{ u.apellido_paterno }}
          </td>

          <td class="px-6 py-4 text-slate-600 dark:text-slate-300">
            {{ u.correo }}
          </td>

          <td class="px-6 py-4">
            <span class="inline-flex items-center px-2.5 py-1 rounded-full text-[11px] font-semibold" [ngClass]="{
            'bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-400': u.rol === 'ADMIN',
            'bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400': u.rol === 'ADMIN_EDITOR',
            'bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-300': u.rol === 'ADMIN_LECTURA'
          }">
              {{ u.rol }}
            </span>
          </td>

          <td class="px-6 py-4 text-slate-700 dark:text-slate-300">
            {{ u.departamento }}
          </td>

          <td class="px-6 py-4 text-center">
            <button type="button" (click)="editPermissions(u)"
              class="text-xs font-semibold text-blue-600 hover:text-blue-800 dark:text-orange-400 dark:hover:text-orange-300 transition">
              Editar permisos
            </button>
          </td>

        </tr>

      </tbody>
    </table>

  </div>

  <!-- ================== FORMULARIO EDITAR PERMISOS ================== -->

  <div *ngIf="isEditing && selectedEmployee"
    class="bg-slate-50 dark:bg-[#020617] border border-slate-200 dark:border-slate-800 rounded-xl p-6 space-y-4">
    <h3 class="text-sm font-semibold text-slate-700 dark:text-slate-200">
      Editar permisos de
      <span class="text-slate-900 dark:text-white">
        {{ selectedEmployee.nombre }} {{ selectedEmployee.apellido_paterno }}
      </span>
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

      <!-- Rol -->
      <div>
        <label class="block text-xs font-semibold text-slate-500 mb-1">
          Rol del sistema
        </label>

        <select [(ngModel)]="selectedEmployee.rol"
          class="form-input-hotel w-full dark:bg-slate-900 dark:border-slate-700 dark:text-white">
          <option value="ADMIN">Administrador</option>
          <option value="ADMIN_EDITOR">Admin editor</option>
          <option value="ADMIN_LECTURA">Admin lectura</option>
          <option value="EMPLEADO">Empleado (sin acceso)</option>
        </select>
      </div>

      <!-- Correo -->
      <div>
        <label class="block text-xs font-semibold text-slate-500 mb-1">
          Correo
        </label>
        <input type="email" [value]="selectedEmployee.correo" disabled
          class="form-input-hotel bg-slate-100 dark:bg-slate-900 dark:border-slate-700 dark:text-slate-300">
      </div>

    </div>

    <!-- Acciones -->
    <div class="flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-800">

      <button type="button" (click)="cancelEdit()"
        class="px-4 py-2 text-xs font-semibold text-slate-600 dark:text-slate-300 hover:text-slate-800 dark:hover:text-white">
        Cancelar
      </button>

      <button type="button" (click)="savePermissions()" class="px-6 py-2 text-xs font-semibold text-white
           bg-orange-500 hover:bg-orange-600 rounded-md">
        Guardar cambios
      </button>

    </div>


  </div>
</div>



<!-- üö´ ACCESO DENEGADO -->
<div *ngIf="!hasAccess" class="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm">

  <div
    class="bg-white dark:bg-[#1e293b] rounded-3xl shadow-2xl p-10 max-w-md w-full text-center animate-in fade-in duration-300">

    <!-- Icono -->
    <div class="mx-auto mb-6 w-20 h-20 rounded-full bg-red-100 dark:bg-red-500/20 flex items-center justify-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 text-red-600 dark:text-red-400" fill="none"
        viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.8">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01M5.455 19h13.09c1.54 0 2.502-1.667 
                 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 
                 0L3.723 16c-.77 1.333.192 3 1.732 3z" />
      </svg>
    </div>

    <!-- Texto -->
    <h2 class="text-xl font-semibold text-slate-800 dark:text-white mb-2">
      Acceso restringido
    </h2>

    <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">
      No tienes permisos para acceder a este m√≥dulo.
      <br>
      Solo usuarios con rol <span class="font-semibold text-red-500">ADMIN</span> pueden ingresar.
    </p>

    <!-- Bot√≥n -->
    <button (click)="goToAdmin()"
      class="px-6 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white text-sm font-medium transition-all shadow-lg hover:shadow-red-500/40">
      Volver al panel
    </button>

  </div>
</div>