<div class="space-y-6">

  <!-- HEADER -->
  <div class="flex items-center justify-between">
    <div>
      <h2 class="text-xl font-semibold text-slate-800 dark:text-slate-100">
        Buzón de Sugerencias
      </h2>
      <p class="text-xs text-slate-400 mt-1">
        Comentarios y observaciones anónimas del personal
      </p>
    </div>
  </div>

  <!-- CONTENEDOR TABLA -->
  <div class="bg-white dark:bg-[#020617] border border-slate-200 dark:border-slate-800 rounded-xl overflow-hidden transition-colors">

    <!-- ESTADOS -->
    <div *ngIf="loading" class="p-10 text-center text-slate-400 text-sm">
      Cargando sugerencias…
    </div>

    <div *ngIf="!loading && !sugerencias.length"
         class="p-10 text-center text-slate-400 text-sm">
      No hay sugerencias registradas
    </div>

    <!-- TABLA -->
    <div *ngIf="!loading && sugerencias.length" class="overflow-x-auto">

      <table class="min-w-full text-sm">

        <!-- HEADER TABLA -->
        <thead class="bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800">
          <tr class="text-xs text-slate-500 uppercase tracking-wider">
            <th class="px-6 py-3 text-left">Fecha</th>
            <th class="px-6 py-3 text-left">Origen</th>
            <th class="px-6 py-3 text-left">Comentario</th>
            <th class="px-6 py-3 text-center">Estado</th>
            <th class="px-6 py-3 text-center">Adjunto</th>
          </tr>
        </thead>

        <tbody class="divide-y divide-slate-100 dark:divide-slate-800">

          <tr
            *ngFor="let s of sugerencias"
            class="hover:bg-slate-50 dark:hover:bg-slate-900 transition cursor-pointer"
            (click)="abrirDetalle(s)">

            <!-- FECHA -->
            <td class="px-6 py-4 text-xs text-slate-500 font-mono whitespace-nowrap">
              {{ s.fecha | date:'yyyy-MM-dd' }}
            </td>

            <!-- ORIGEN -->
            <td class="px-6 py-4">
              <span
                class="inline-flex items-center px-2.5 py-1 rounded-full
                       text-[11px] font-semibold bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300">
                Anónima
              </span>
            </td>

            <!-- COMENTARIO -->
            <td class="px-6 py-4">
              <p class="text-slate-700 dark:text-slate-300 truncate max-w-lg leading-snug">
                {{ s.comentario }}
              </p>
            </td>

            <!-- ESTADO -->
            <td class="px-6 py-4 text-center">
              <span
                class="inline-flex items-center px-2.5 py-1 rounded-full
                       text-[11px] font-semibold bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400">
                Nueva
              </span>
            </td>

            <!-- IMAGEN PREVIEW -->
            <td class="px-6 py-4 text-center">
              <ng-container *ngIf="s.imagen; else sinImagen">
                <img
                  [src]="'http://localhost:3000' + s.imagen"
                  class="w-10 h-10 object-cover rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm mx-auto">
              </ng-container>

              <ng-template #sinImagen>
                <span class="text-xs text-slate-300 italic">—</span>
              </ng-template>
            </td>

          </tr>

        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- ================= PANEL LATERAL ================= -->
<div *ngIf="verSugerencia && sugerenciaSeleccionada"
     class="fixed inset-0 z-50 flex justify-end">

  <!-- OVERLAY -->
  <div
    class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm"
    (click)="cerrarDetalle()">
  </div>

  <!-- DRAWER -->
  <div
    class="relative w-full max-w-lg h-full bg-white dark:bg-[#020617] shadow-2xl
           animate-in slide-in-from-right duration-300
           flex flex-col transition-colors">

    <!-- HEADER DRAWER -->
    <div class="p-6 border-b border-slate-200 dark:border-slate-800 flex justify-between items-start">
      <div>
        <h3 class="text-lg font-semibold text-slate-800 dark:text-slate-100">
          Sugerencia recibida
        </h3>
        <p class="text-xs text-slate-400 mt-1">
          {{ sugerenciaSeleccionada.fecha | date:'yyyy-MM-dd' }}
        </p>
      </div>

      <button
        (click)="cerrarDetalle()"
        class="p-2 rounded-md hover:bg-slate-100 dark:hover:bg-slate-800 transition">
        ✕
      </button>
    </div>

    <!-- CONTENIDO DRAWER -->
    <div class="flex-1 overflow-y-auto p-6 space-y-6">

      <!-- ORIGEN -->
      <div>
        <p class="text-xs uppercase tracking-wider text-slate-400 mb-2">
          Origen
        </p>
        <span
          class="inline-flex px-3 py-1 rounded-full text-xs font-semibold
                 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300">
          Anónima
        </span>
      </div>

      <!-- MENSAJE COMPLETO -->
      <div>
        <p class="text-xs uppercase tracking-wider text-slate-400 mb-2">
          Comentario completo
        </p>
        <div
          class="bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-xl p-4
                 text-slate-700 dark:text-slate-300 leading-relaxed text-sm whitespace-pre-line">
          {{ sugerenciaSeleccionada.comentario }}
        </div>
      </div>

      <!-- IMAGEN GRANDE -->
      <div *ngIf="sugerenciaSeleccionada.imagen">
        <p class="text-xs uppercase tracking-wider text-slate-400 mb-2">
          Evidencia adjunta
        </p>
        <img
          [src]="'http://localhost:3000' + sugerenciaSeleccionada.imagen"
          class="w-full rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm object-contain max-h-[350px]">
      </div>

      <div *ngIf="!sugerenciaSeleccionada.imagen"
           class="text-xs text-slate-400 italic">
        No se adjuntó imagen
      </div>

    </div>

    <!-- FOOTER DRAWER -->
    <div class="p-6 border-t border-slate-200 dark:border-slate-800">
      <button
        class="w-full px-4 py-3 rounded-md
               bg-emerald-600 text-white text-xs font-semibold
               hover:bg-emerald-700 transition">
        Marcar como atendida
      </button>
    </div>

  </div>
</div>
