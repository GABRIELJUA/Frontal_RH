<main class="max-w-7xl mx-auto px-4 sm:px-6 py-12 space-y-10"
      aria-labelledby="biblioteca-title">

  <!-- ================= HEADER ================= -->
  <header class="text-center space-y-3">

    <h1 id="biblioteca-title"
        class="text-2xl sm:text-3xl font-bold text-slate-800 dark:text-white">
      Biblioteca Digital
    </h1>

    <p class="text-sm text-slate-500 dark:text-slate-400 max-w-xl mx-auto">
      Manuales, reglamentos y formatos disponibles para consulta y descarga.
    </p>

  </header>


  <!-- ================= LOADING ================= -->
  <section *ngIf="loading"
           class="text-center py-24 text-slate-400 text-sm"
           aria-live="polite">
    Cargando documentos...
  </section>


  <!-- ================= VACÍO ================= -->
  <section *ngIf="!loading && !documentos.length"
           class="text-center py-24 text-slate-400 text-sm">
    No hay documentos disponibles.
  </section>


  <!-- ================= GRID DOCUMENTOS ================= -->
  <section *ngIf="!loading && documentos.length"
           class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"
           aria-label="Lista de documentos disponibles">

    <article *ngFor="let d of documentos; trackBy: trackByDocumento"
             class="bg-white dark:bg-[#020617]
                    border border-slate-200 dark:border-slate-800
                    rounded-2xl p-5
                    hover:shadow-lg transition
                    flex flex-col justify-between">

      <!-- ===== PREVIEW ===== -->
      <div class="mb-4">

        <!-- IMAGEN -->
        <img *ngIf="getTipoArchivo(d.archivo_url)==='image'"
             [src]="getFileUrl(d.archivo_url)"
             [alt]="'Vista previa del documento ' + d.titulo"
             loading="lazy"
             width="400"
             height="250"
             class="w-full h-36 object-cover rounded-lg border
                    border-slate-200 dark:border-slate-700">

        <!-- PDF -->
        <div *ngIf="getTipoArchivo(d.archivo_url)==='pdf'"
             class="rounded-lg overflow-hidden border
                    border-slate-200 dark:border-slate-700 bg-white">

          <iframe [src]="getSafePdfUrl(d.archivo_url)"
                  title="Vista previa PDF"
                  loading="lazy"
                  class="w-full h-40">
          </iframe>

        </div>

        <!-- OTROS ARCHIVOS -->
        <div *ngIf="getTipoArchivo(d.archivo_url)==='file'"
             class="flex items-center justify-center py-6">

          <div class="w-14 h-14 rounded-xl
                      bg-white dark:bg-slate-800
                      border border-slate-200 dark:border-slate-700
                      flex items-center justify-center shadow-sm">

            <img [src]="getIconoArchivo(d.archivo_url)"
                 alt="Icono del tipo de archivo"
                 loading="lazy"
                 width="32"
                 height="32"
                 class="w-8 h-8 object-contain">

          </div>

        </div>

      </div>



      <!-- ===== INFORMACIÓN ===== -->
      <div class="space-y-2">

        <h2 class="font-semibold text-slate-800 dark:text-white text-sm line-clamp-2">
          {{ d.titulo }}
        </h2>

        <p class="text-xs text-slate-400 truncate">
          {{ d.archivo_url?.split('/').pop() }}
        </p>

        <div>
          <span class="text-[11px] px-2 py-1 rounded-full
                       bg-slate-100 dark:bg-slate-800
                       text-slate-600 dark:text-slate-300 font-semibold">
            {{ d.categoria || 'Documento' }}
          </span>
        </div>

        <p class="text-[10px] text-slate-400">
          {{ d.fecha_subida | date:'yyyy-MM-dd' }}
        </p>

      </div>


      <!-- ===== BOTÓN ===== -->
      <div class="mt-4 pt-3 border-t border-slate-100 dark:border-slate-800">

        <a [href]="getFileUrl(d.archivo_url)"
           target="_blank"
           rel="noopener noreferrer"
           class="text-xs font-semibold text-blue-600 hover:text-blue-800
                  dark:text-orange-400 dark:hover:text-orange-300
                  transition focus:outline-none focus:ring-2 focus:ring-blue-400 rounded">

          Abrir documento

        </a>

      </div>

    </article>

  </section>

</main>